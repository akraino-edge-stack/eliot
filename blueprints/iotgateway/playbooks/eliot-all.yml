#
# Copyright 2020 Huawei Technologies Co., Ltd.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

---

############ OCD ############

- hosts: ocdconsolidated
  become: yes
  tags:
    - ocdhost
    - ocdconsolidated

  roles:
    - k8s
    - helm
    - docker
    - eg_prerequisite
    - eg_registry
    - eg_helm-repo
    - eg_certs

############ Master ############

### Pre-Requisites ###

- hosts: prerequisitemaster
  become: yes
  tags:
    - prerequisitemaster
    - master

  roles:
    - eg_trans_certs
    - eg_prerequisite
    - helm
    - eg_set-helm-repo
    - kubeconfig

### Other 3rd party related ###

- hosts: thirdpartymaster
  become: yes
  tags:
    - thirdpartymaster
    - master

  roles:
    - grafana

### EdgeGallery related ###

- hosts: egmaster
  become: yes
  tags:
    - egmaster
    - master

  roles:
    - eg_secret
    - service_center
    - eg_user-mgmt
    - eg_mecm-meo
    - eg_mecm-fe
    - eg_appstore
    - eg_developer


############ Edge ############

### Infrastructure ###
- hosts: edge-infra
  become: yes
  tags:
    - edge-infra
    - edge

  roles:
    - eg_trans_certs
    - docker
    - eg_prerequisite
    - k3s

### Pre-Requisites ###

- hosts: prerequisiteedge
  become: yes
  tags:
    - prerequisiteedge
    - edge

  roles:
    - helm

### Other 3rd party related ###

- hosts: thirdpartyedge
  become: yes
  tags:
    - thirdpartyedge
    - edge

  roles:
    - rabbitmq
    - prometheus
    - kubeconfig
    - mepkubeconfig
    - cadvisor
    - el_edgex
    - el_opc-au
    - el_hawkbit

### EdgeGallery related ###

- hosts: egedge
  become: yes
  tags:
    - egedge
    - edge

  roles:
    - eg_secret
    - eg_set-helm-repo
    - eg_mep
    - eg_mecm-mepm
